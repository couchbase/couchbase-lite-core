<!--
Copyright 2017-Present Couchbase, Inc.
Use of this software is governed by the Business Source License included in
the file licenses/BSL-Couchbase.txt.  As of the Change Date specified in that
file, in accordance with the Business Source License, use of this software will
be governed by the Apache License, Version 2.0, included in the file
licenses/APL2.txt.
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LiteCore: C4SocketFactory Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LiteCore
   </div>
   <div id="projectbrief">Couchbase Lite cross-platform core implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">C4SocketFactory Struct Reference<div class="ingroups"><a class="el" href="group___socket.html">Replication Socket Provider API</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A group of callbacks that define the implementation of sockets; the client must fill this out and pass it to <a class="el" href="group___socket.html#gaee208cc2aedf57c8dc0549a707f25026" title="One-time registration of socket callbacks.">c4socket_registerFactory()</a> before using any socket-based API.  
 <a href="struct_c4_socket_factory.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="c4_socket_types_8h_source.html">c4SocketTypes.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a59f72686ba30d6f617fd321d4516cf1a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___socket.html#ga4fd4a7216b3eec47914dc868c81dea01">C4SocketFraming</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c4_socket_factory.html#a59f72686ba30d6f617fd321d4516cf1a">framing</a></td></tr>
<tr class="memdesc:a59f72686ba30d6f617fd321d4516cf1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This should be set to <code>kC4NoFraming</code> if the socket factory acts as a stream of messages, <code>kC4WebSocketClientFraming</code> or <code>kC4WebSocketServerFraming</code> if it's a byte stream.  <a href="#a59f72686ba30d6f617fd321d4516cf1a">More...</a><br /></td></tr>
<tr class="separator:a59f72686ba30d6f617fd321d4516cf1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b2c029e9555277d759c3b44cf4a53d"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c4_socket_factory.html#ae4b2c029e9555277d759c3b44cf4a53d">context</a></td></tr>
<tr class="memdesc:ae4b2c029e9555277d759c3b44cf4a53d"><td class="mdescLeft">&#160;</td><td class="mdescRight">An arbitrary value that will be passed to the <code>open</code> callback.  <a href="#ae4b2c029e9555277d759c3b44cf4a53d">More...</a><br /></td></tr>
<tr class="separator:ae4b2c029e9555277d759c3b44cf4a53d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68da57161fe57a9fad555237940a9171"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c4_socket_factory.html#a68da57161fe57a9fad555237940a9171">open</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, const <a class="el" href="struct_c4_address.html">C4Address</a> *addr, <a class="el" href="group___base.html#gac99d7d179bccd9bbaf29b28272975b47">C4Slice</a> options, void *C4NULLABLEcontext)</td></tr>
<tr class="memdesc:a68da57161fe57a9fad555237940a9171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to open a socket to a destination address, asynchronously.  <a href="#a68da57161fe57a9fad555237940a9171">More...</a><br /></td></tr>
<tr class="separator:a68da57161fe57a9fad555237940a9171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4817eb8fdf6fd8746958d45dfcb311b"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c4_socket_factory.html#ae4817eb8fdf6fd8746958d45dfcb311b">write</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, <a class="el" href="group___base.html#ga7641ec7c9f4339b65cc4aabc050d67d8">C4SliceResult</a> allocatedData)</td></tr>
<tr class="memdesc:ae4817eb8fdf6fd8746958d45dfcb311b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to write to the socket.  <a href="#ae4817eb8fdf6fd8746958d45dfcb311b">More...</a><br /></td></tr>
<tr class="separator:ae4817eb8fdf6fd8746958d45dfcb311b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a102507568c0639da02a1efd730c9fd1b"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c4_socket_factory.html#a102507568c0639da02a1efd730c9fd1b">completedReceive</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, size_t byteCount)</td></tr>
<tr class="memdesc:a102507568c0639da02a1efd730c9fd1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to inform the socket that LiteCore has finished processing the data from a <code><a class="el" href="group___socket.html#ga1e1797e15c6cd30c0a1a16844f0f8b2f" title="Notifies LiteCore that data was received from the socket.">c4socket_received()</a></code> call.  <a href="#a102507568c0639da02a1efd730c9fd1b">More...</a><br /></td></tr>
<tr class="separator:a102507568c0639da02a1efd730c9fd1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5292df8c6bdae3a87011e565c4a09ff2"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c4_socket_factory.html#a5292df8c6bdae3a87011e565c4a09ff2">close</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket)</td></tr>
<tr class="memdesc:a5292df8c6bdae3a87011e565c4a09ff2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to close the socket.  <a href="#a5292df8c6bdae3a87011e565c4a09ff2">More...</a><br /></td></tr>
<tr class="separator:a5292df8c6bdae3a87011e565c4a09ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3a2bbe301941260e172bbd477db10d7"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c4_socket_factory.html#ab3a2bbe301941260e172bbd477db10d7">requestClose</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, int status, <a class="el" href="group___base.html#ga04de3d84e73df3c8b75092054abcc117">C4String</a> message)</td></tr>
<tr class="memdesc:ab3a2bbe301941260e172bbd477db10d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to close the socket.  <a href="#ab3a2bbe301941260e172bbd477db10d7">More...</a><br /></td></tr>
<tr class="separator:ab3a2bbe301941260e172bbd477db10d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0ceb1788a8526b5c6ba41cfe25f9651"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c4_socket_factory.html#ac0ceb1788a8526b5c6ba41cfe25f9651">dispose</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket)</td></tr>
<tr class="memdesc:ac0ceb1788a8526b5c6ba41cfe25f9651"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to tell the client that a <code>C4Socket</code> object is being disposed/freed after it's closed.  <a href="#ac0ceb1788a8526b5c6ba41cfe25f9651">More...</a><br /></td></tr>
<tr class="separator:ac0ceb1788a8526b5c6ba41cfe25f9651"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A group of callbacks that define the implementation of sockets; the client must fill this out and pass it to <a class="el" href="group___socket.html#gaee208cc2aedf57c8dc0549a707f25026" title="One-time registration of socket callbacks.">c4socket_registerFactory()</a> before using any socket-based API. </p>
<p>A group of callbacks that define the implementation of sockets.</p>
<p>These callbacks will be invoked on arbitrary background threads owned by LiteCore. They should return quickly, and perform the operation asynchronously without blocking.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="a5292df8c6bdae3a87011e565c4a09ff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5292df8c6bdae3a87011e565c4a09ff2">&#9670;&nbsp;</a></span>close</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(*  C4SocketFactory::close) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to close the socket. </p>
<p>This is only called if <code>framing</code> doesn't equal <code>kC4NoFraming</code>, i.e. the socket operates at the byte level. Otherwise it may be left NULL. No more write calls will be made; the socket should process any remaining incoming bytes by calling <code><a class="el" href="group___socket.html#ga1e1797e15c6cd30c0a1a16844f0f8b2f" title="Notifies LiteCore that data was received from the socket.">c4socket_received()</a></code>, then call <code><a class="el" href="group___socket.html#ga322960ea95270309dce56f4415c11240" title="Notifies LiteCore that a socket has finished closing, or disconnected, or failed to open.">c4socket_closed()</a></code> when the socket closes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket to close. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a102507568c0639da02a1efd730c9fd1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a102507568c0639da02a1efd730c9fd1b">&#9670;&nbsp;</a></span>completedReceive</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* C4SocketFactory::completedReceive) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, size_t byteCount)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to inform the socket that LiteCore has finished processing the data from a <code><a class="el" href="group___socket.html#ga1e1797e15c6cd30c0a1a16844f0f8b2f" title="Notifies LiteCore that data was received from the socket.">c4socket_received()</a></code> call. </p>
<p>This can be used for flow control. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket that whose incoming data was processed. </td></tr>
    <tr><td class="paramname">byteCount</td><td>The number of bytes of data processed (the size of the <code>data</code> slice passed to a <code><a class="el" href="group___socket.html#ga1e1797e15c6cd30c0a1a16844f0f8b2f" title="Notifies LiteCore that data was received from the socket.">c4socket_received()</a></code> call.) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae4b2c029e9555277d759c3b44cf4a53d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b2c029e9555277d759c3b44cf4a53d">&#9670;&nbsp;</a></span>context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* C4SocketFactory::context</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>An arbitrary value that will be passed to the <code>open</code> callback. </p>

</div>
</div>
<a id="ac0ceb1788a8526b5c6ba41cfe25f9651"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0ceb1788a8526b5c6ba41cfe25f9651">&#9670;&nbsp;</a></span>dispose</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(*  C4SocketFactory::dispose) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to tell the client that a <code>C4Socket</code> object is being disposed/freed after it's closed. </p>
<p>The implementation of this function can then dispose any state associated with the <code>nativeHandle</code>. Set this to NULL if you don't need the call. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket being disposed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a59f72686ba30d6f617fd321d4516cf1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59f72686ba30d6f617fd321d4516cf1a">&#9670;&nbsp;</a></span>framing</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___socket.html#ga4fd4a7216b3eec47914dc868c81dea01">C4SocketFraming</a> C4SocketFactory::framing</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This should be set to <code>kC4NoFraming</code> if the socket factory acts as a stream of messages, <code>kC4WebSocketClientFraming</code> or <code>kC4WebSocketServerFraming</code> if it's a byte stream. </p>

</div>
</div>
<a id="a68da57161fe57a9fad555237940a9171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68da57161fe57a9fad555237940a9171">&#9670;&nbsp;</a></span>open</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* C4SocketFactory::open) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, const <a class="el" href="struct_c4_address.html">C4Address</a> *addr, <a class="el" href="group___base.html#gac99d7d179bccd9bbaf29b28272975b47">C4Slice</a> options, void *C4NULLABLEcontext)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to open a socket to a destination address, asynchronously. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>A new C4Socket instance to be opened. Its <code>nativeHandle</code> will be NULL; the implementation of this function will probably store a native socket reference there. This function should return immediately instead of waiting for the connection to open. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab3a2bbe301941260e172bbd477db10d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3a2bbe301941260e172bbd477db10d7">&#9670;&nbsp;</a></span>requestClose</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(*  C4SocketFactory::requestClose) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, int status, <a class="el" href="group___base.html#ga04de3d84e73df3c8b75092054abcc117">C4String</a> message)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to close the socket. </p>
<p>This is only called if <code>framing</code> equals to <code>kC4NoFraming</code>, i.e. the socket operates at the message level. Otherwise it may be left NULL. The implementation should send a message that tells the remote peer that it's closing the connection, then wait for acknowledgement before closing. No more write calls will be made; the socket should process any remaining incoming messages by calling <code><a class="el" href="group___socket.html#ga1e1797e15c6cd30c0a1a16844f0f8b2f" title="Notifies LiteCore that data was received from the socket.">c4socket_received()</a></code>, then call <code><a class="el" href="group___socket.html#ga322960ea95270309dce56f4415c11240" title="Notifies LiteCore that a socket has finished closing, or disconnected, or failed to open.">c4socket_closed()</a></code> when the connection closes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket to close. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae4817eb8fdf6fd8746958d45dfcb311b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4817eb8fdf6fd8746958d45dfcb311b">&#9670;&nbsp;</a></span>write</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* C4SocketFactory::write) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, <a class="el" href="group___base.html#ga7641ec7c9f4339b65cc4aabc050d67d8">C4SliceResult</a> allocatedData)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to write to the socket. </p>
<p>If <code>framing</code> equals to <code>kC4NoFraming</code>, the data is a complete message, and the socket implementation is responsible for framing it; in other case, it's just raw bytes to write to the stream, including the necessary framing. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket to write to. </td></tr>
    <tr><td class="paramname">allocatedData</td><td>The data/message to send. As this is a <code>C4SliceResult</code>, the implementation of this function is responsible for freeing it when done. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="c4_socket_types_8h_source.html">c4SocketTypes.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
