<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LiteCore: C4SocketFactory Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LiteCore
   </div>
   <div id="projectbrief">Couchbase Lite cross-platform core implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">C4SocketFactory Struct Reference<div class="ingroups"><a class="el" href="group___socket.html">Replication Socket Provider API</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>A group of callbacks that define the implementation of sockets; the client must fill this out and pass it to <a class="el" href="group___socket.html#gaca3692b1a8c065365bf06a01c869aa62" title="One-time registration of default socket callbacks.">c4socket_registerFactory()</a> before using any socket-based API.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="c4_socket_types_8h_source.html">c4SocketTypes.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a59f72686ba30d6f617fd321d4516cf1a" id="r_a59f72686ba30d6f617fd321d4516cf1a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___socket.html#ga4fd4a7216b3eec47914dc868c81dea01">C4SocketFraming</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a59f72686ba30d6f617fd321d4516cf1a">framing</a></td></tr>
<tr class="memdesc:a59f72686ba30d6f617fd321d4516cf1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This should be set to <code>kC4NoFraming</code> if the socket factory acts as a stream of messages, <code>kC4WebSocketClientFraming</code> or <code>kC4WebSocketServerFraming</code> if it's a byte stream.  <br /></td></tr>
<tr class="separator:a59f72686ba30d6f617fd321d4516cf1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b2c029e9555277d759c3b44cf4a53d" id="r_ae4b2c029e9555277d759c3b44cf4a53d"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae4b2c029e9555277d759c3b44cf4a53d">context</a></td></tr>
<tr class="memdesc:ae4b2c029e9555277d759c3b44cf4a53d"><td class="mdescLeft">&#160;</td><td class="mdescRight">An arbitrary value that will be passed to the <code>open</code> callback.  <br /></td></tr>
<tr class="separator:ae4b2c029e9555277d759c3b44cf4a53d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a400fcaa9fecba9a8b5346c8b2cc1cd2a" id="r_a400fcaa9fecba9a8b5346c8b2cc1cd2a"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a400fcaa9fecba9a8b5346c8b2cc1cd2a">open</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, const <a class="el" href="struct_c4_address.html">C4Address</a> *addr, <a class="el" href="group___base.html#gac99d7d179bccd9bbaf29b28272975b47">C4Slice</a> options, void *<a class="el" href="#ae4b2c029e9555277d759c3b44cf4a53d">context</a>)</td></tr>
<tr class="memdesc:a400fcaa9fecba9a8b5346c8b2cc1cd2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to open a socket to a destination address.  <br /></td></tr>
<tr class="separator:a400fcaa9fecba9a8b5346c8b2cc1cd2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4817eb8fdf6fd8746958d45dfcb311b" id="r_ae4817eb8fdf6fd8746958d45dfcb311b"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae4817eb8fdf6fd8746958d45dfcb311b">write</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, <a class="el" href="group___base.html#ga7641ec7c9f4339b65cc4aabc050d67d8">C4SliceResult</a> allocatedData)</td></tr>
<tr class="memdesc:ae4817eb8fdf6fd8746958d45dfcb311b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to write to the socket.  <br /></td></tr>
<tr class="separator:ae4817eb8fdf6fd8746958d45dfcb311b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a102507568c0639da02a1efd730c9fd1b" id="r_a102507568c0639da02a1efd730c9fd1b"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a102507568c0639da02a1efd730c9fd1b">completedReceive</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, size_t byteCount)</td></tr>
<tr class="memdesc:a102507568c0639da02a1efd730c9fd1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to inform the socket that LiteCore has finished processing the data from a <a class="el" href="group___socket.html#gaa4174b27270aa807cf36298d3f2a8bc0">c4socket_received</a> call.  <br /></td></tr>
<tr class="separator:a102507568c0639da02a1efd730c9fd1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70dbc477a35dac099b9478d78fed2c28" id="r_a70dbc477a35dac099b9478d78fed2c28"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a70dbc477a35dac099b9478d78fed2c28">close</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket)</td></tr>
<tr class="memdesc:a70dbc477a35dac099b9478d78fed2c28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to close the socket.  <br /></td></tr>
<tr class="separator:a70dbc477a35dac099b9478d78fed2c28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37f44e93f513ebafde1da3612ed5f39" id="r_ab37f44e93f513ebafde1da3612ed5f39"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab37f44e93f513ebafde1da3612ed5f39">requestClose</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, int status, <a class="el" href="group___base.html#ga04de3d84e73df3c8b75092054abcc117">C4String</a> message)</td></tr>
<tr class="memdesc:ab37f44e93f513ebafde1da3612ed5f39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to close the socket.  <br /></td></tr>
<tr class="separator:ab37f44e93f513ebafde1da3612ed5f39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54f2b9f38eeee2bffcc6da3fc0d35654" id="r_a54f2b9f38eeee2bffcc6da3fc0d35654"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a54f2b9f38eeee2bffcc6da3fc0d35654">dispose</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket)</td></tr>
<tr class="memdesc:a54f2b9f38eeee2bffcc6da3fc0d35654"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to tell the client that a <code><a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2" title="Represents an open bidirectional stream of bytes or messages (typically a TCP socket....">C4Socket</a></code> object is being disposed/freed after it's closed.  <br /></td></tr>
<tr class="separator:a54f2b9f38eeee2bffcc6da3fc0d35654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8022d309ca045bde882a1ba30a29b58d" id="r_a8022d309ca045bde882a1ba30a29b58d"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8022d309ca045bde882a1ba30a29b58d">attached</a> )(<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket)</td></tr>
<tr class="memdesc:a8022d309ca045bde882a1ba30a29b58d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when a factory and native handle are attached to a new <a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2" title="Represents an open bidirectional stream of bytes or messages (typically a TCP socket....">C4Socket</a> by calling <code>c4socket_fromNative</code> or <code>C4Socket::fromNative</code>.  <br /></td></tr>
<tr class="separator:a8022d309ca045bde882a1ba30a29b58d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A group of callbacks that define the implementation of sockets; the client must fill this out and pass it to <a class="el" href="group___socket.html#gaca3692b1a8c065365bf06a01c869aa62" title="One-time registration of default socket callbacks.">c4socket_registerFactory()</a> before using any socket-based API. </p>
<p>A group of callbacks that define the implementation of sockets.</p>
<p>These callbacks will be invoked on arbitrary background threads owned by LiteCore. They should return quickly, and perform the operation asynchronously without blocking. </p>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="a8022d309ca045bde882a1ba30a29b58d" name="a8022d309ca045bde882a1ba30a29b58d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8022d309ca045bde882a1ba30a29b58d">&#9670;&#160;</a></span>attached</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* C4SocketFactory::attached) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when a factory and native handle are attached to a new <a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2" title="Represents an open bidirectional stream of bytes or messages (typically a TCP socket....">C4Socket</a> by calling <code>c4socket_fromNative</code> or <code>C4Socket::fromNative</code>. </p>
<p>The <a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2" title="Represents an open bidirectional stream of bytes or messages (typically a TCP socket....">C4Socket</a>'s nativeHandle will already be set.</p>
<p>Set this to NULL if you don't need the call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket being attached. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a70dbc477a35dac099b9478d78fed2c28" name="a70dbc477a35dac099b9478d78fed2c28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70dbc477a35dac099b9478d78fed2c28">&#9670;&#160;</a></span>close</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* C4SocketFactory::close) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to close the socket. </p>
<p>This is only called if <code>framing</code> doesn't equal <code>kC4NoFraming</code>, i.e. the socket operates at the byte level. Otherwise it may be left NULL. No more write calls will be made; you should process any remaining incoming bytes by calling <a class="el" href="group___socket.html#gaa4174b27270aa807cf36298d3f2a8bc0">c4socket_received</a>, then call <a class="el" href="group___socket.html#ga10e386c542c72401431f9f00443dc0d4">c4socket_closed</a> when the socket closes. </p><dl class="section warning"><dt>Warning</dt><dd>You MUST call <a class="el" href="group___socket.html#ga10e386c542c72401431f9f00443dc0d4">c4socket_closed</a>, or the replicator will wait forever!</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket to close. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a102507568c0639da02a1efd730c9fd1b" name="a102507568c0639da02a1efd730c9fd1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a102507568c0639da02a1efd730c9fd1b">&#9670;&#160;</a></span>completedReceive</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* C4SocketFactory::completedReceive) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, size_t byteCount)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to inform the socket that LiteCore has finished processing the data from a <a class="el" href="group___socket.html#gaa4174b27270aa807cf36298d3f2a8bc0">c4socket_received</a> call. </p>
<p>This can be used for flow control: you should keep track of the number of bytes you've sent to LiteCore, incrementing the number when you call <a class="el" href="group___socket.html#gaa4174b27270aa807cf36298d3f2a8bc0">c4socket_received</a>, and decrementing it when <code>completedReceived</code> is called. If the number goes above some threshold, you should take measures to stop receiving more data, e.g. by not reading more bytes from the socket. Otherwise memory usage can balloon as more and more data arrives and must be buffered in memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket that whose incoming data was processed. </td></tr>
    <tr><td class="paramname">byteCount</td><td>The number of bytes of data processed (the size of the <code>data</code> slice passed to a <code><a class="el" href="group___socket.html#gaa4174b27270aa807cf36298d3f2a8bc0" title="Notifies LiteCore that data was received from the socket.">c4socket_received()</a></code> call.) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae4b2c029e9555277d759c3b44cf4a53d" name="ae4b2c029e9555277d759c3b44cf4a53d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b2c029e9555277d759c3b44cf4a53d">&#9670;&#160;</a></span>context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* C4SocketFactory::context</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>An arbitrary value that will be passed to the <code>open</code> callback. </p>

</div>
</div>
<a id="a54f2b9f38eeee2bffcc6da3fc0d35654" name="a54f2b9f38eeee2bffcc6da3fc0d35654"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54f2b9f38eeee2bffcc6da3fc0d35654">&#9670;&#160;</a></span>dispose</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* C4SocketFactory::dispose) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to tell the client that a <code><a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2" title="Represents an open bidirectional stream of bytes or messages (typically a TCP socket....">C4Socket</a></code> object is being disposed/freed after it's closed. </p>
<p>The implementation of this function can then dispose any state associated with the <code>nativeHandle</code>.</p>
<p>Set this to NULL if you don't need the call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket being disposed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a59f72686ba30d6f617fd321d4516cf1a" name="a59f72686ba30d6f617fd321d4516cf1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59f72686ba30d6f617fd321d4516cf1a">&#9670;&#160;</a></span>framing</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___socket.html#ga4fd4a7216b3eec47914dc868c81dea01">C4SocketFraming</a> C4SocketFactory::framing</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This should be set to <code>kC4NoFraming</code> if the socket factory acts as a stream of messages, <code>kC4WebSocketClientFraming</code> or <code>kC4WebSocketServerFraming</code> if it's a byte stream. </p>

</div>
</div>
<a id="a400fcaa9fecba9a8b5346c8b2cc1cd2a" name="a400fcaa9fecba9a8b5346c8b2cc1cd2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a400fcaa9fecba9a8b5346c8b2cc1cd2a">&#9670;&#160;</a></span>open</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* C4SocketFactory::open) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, const <a class="el" href="struct_c4_address.html">C4Address</a> *addr, <a class="el" href="group___base.html#gac99d7d179bccd9bbaf29b28272975b47">C4Slice</a> options, void *<a class="el" href="#ae4b2c029e9555277d759c3b44cf4a53d">context</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to open a socket to a destination address. </p>
<p>This function should operate asynchronously, returning immediately. When the socket opens, call <a class="el" href="group___socket.html#ga9c90b1431667215b45a336e92baa332c">c4socket_opened</a>, or if it fails to open, call <a class="el" href="group___socket.html#ga10e386c542c72401431f9f00443dc0d4">c4socket_closed</a> with an appropriate error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>A new <a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2" title="Represents an open bidirectional stream of bytes or messages (typically a TCP socket....">C4Socket</a> instance to be opened. Its <code>nativeHandle</code> will be NULL; the implementation of this function will probably store a native socket reference there. </td></tr>
    <tr><td class="paramname">addr</td><td>The address (URL) to connect to. </td></tr>
    <tr><td class="paramname">options</td><td>A Fleece-encoded dictionary containing additional parameters, such as <code>kC4SocketOptionWSProtocols</code>, which provides the WebSocket protocol names to include in the HTTP request header. </td></tr>
    <tr><td class="paramname">context</td><td>The value of the <code><a class="el" href="struct_c4_socket_factory.html" title="A group of callbacks that define the implementation of sockets; the client must fill this out and pas...">C4SocketFactory</a></code>'s <code>context</code> field. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab37f44e93f513ebafde1da3612ed5f39" name="ab37f44e93f513ebafde1da3612ed5f39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab37f44e93f513ebafde1da3612ed5f39">&#9670;&#160;</a></span>requestClose</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* C4SocketFactory::requestClose) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, int status, <a class="el" href="group___base.html#ga04de3d84e73df3c8b75092054abcc117">C4String</a> message)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to close the socket. </p>
<p>This is only called if <code>framing</code> equals to <code>kC4NoFraming</code>, i.e. the socket operates at the message level. Otherwise it may be left NULL.</p>
<p>Your implementation should:</p><ol type="1">
<li>send a message that tells the remote peer that it's closing the connection;</li>
<li>wait for acknowledgement;</li>
<li>while waiting, handle any further incoming messages by calling <a class="el" href="group___socket.html#gaa4174b27270aa807cf36298d3f2a8bc0">c4socket_received</a>;</li>
<li>after 5 seconds of waiting, give up and go to step 5;</li>
<li>upon acknowledgement or timeout, close its connection and call <a class="el" href="group___socket.html#ga10e386c542c72401431f9f00443dc0d4">c4socket_closed</a>.</li>
</ol>
<p>This call can also occur <em>before</em> the socket has opened, if the replicator decides to time out. In this situation &ndash; i.e. if you have not yet called <a class="el" href="group___socket.html#ga9c90b1431667215b45a336e92baa332c">c4socket_opened</a> &ndash; you should tear down your connection and call <a class="el" href="group___socket.html#ga10e386c542c72401431f9f00443dc0d4">c4socket_closed</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>You MUST call <a class="el" href="group___socket.html#ga10e386c542c72401431f9f00443dc0d4">c4socket_closed</a>, or the replicator will wait forever!</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The <code><a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2" title="Represents an open bidirectional stream of bytes or messages (typically a TCP socket....">C4Socket</a></code> to close. </td></tr>
    <tr><td class="paramname">status</td><td>The WebSocket status code to send in the CLOSE message. </td></tr>
    <tr><td class="paramname">message</td><td>The text to send in the CLOSE message. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae4817eb8fdf6fd8746958d45dfcb311b" name="ae4817eb8fdf6fd8746958d45dfcb311b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4817eb8fdf6fd8746958d45dfcb311b">&#9670;&#160;</a></span>write</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* C4SocketFactory::write) (<a class="el" href="group___base.html#gae56f69f380fa40d8ee42f087416bb1e2">C4Socket</a> *socket, <a class="el" href="group___base.html#ga7641ec7c9f4339b65cc4aabc050d67d8">C4SliceResult</a> allocatedData)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to write to the socket. </p>
<p>If <code>framing</code> equals <code>kC4NoFraming</code>, the data is a complete message, and your socket implementation is responsible for framing it; otherwise, it's just raw bytes to write to the stream, including the necessary WebSocket framing.</p>
<p>After data has been written, you must call <a class="el" href="group___socket.html#ga63ae9bc512dcebf50e7b7697e37c33a5">c4socket_completedWrite</a>. (You can call this once after all the data is written, or multiple times with smaller numbers, as long as the total byte count equals the size of the <code>allocatedData</code>.)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket to write to. </td></tr>
    <tr><td class="paramname">allocatedData</td><td>The data/message to send. As this is a <code><a class="el" href="group___base.html#ga7641ec7c9f4339b65cc4aabc050d67d8">C4SliceResult</a></code>, your implementation of this function is responsible for releasing it when done. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="c4_socket_types_8h_source.html">c4SocketTypes.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
